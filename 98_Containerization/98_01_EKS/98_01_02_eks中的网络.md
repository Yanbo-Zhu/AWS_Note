# 1 EKS network architecture 


![](image/Pasted%20image%2020240711201524.png)



# 2 worker nodes 层面

![](image/Pasted%20image%2020240711201603.png)



![](image/Pasted%20image%2020240711201618.png)


![](image/Pasted%20image%2020240711201737.png)

ENI: elastic network interface, 网卡 
CNI: Container network interface, 容器网络接口 

给每一个Pod 一个 cidr range, 这个 cider range 是放到 warm poll 中的 

## 2.1 CNI Plugin 

Every container get its own IP address (CNI-VPC Plugin)
![](image/Pasted%20image%2020240711202143.png)


![](image/Pasted%20image%2020240711202308.png)


![](image/Pasted%20image%2020240711202521.png)


![](image/Pasted%20image%2020240711202603.png)


## 2.2 CNI 的介绍 

![](image/Pasted%20image%2020240711203339.png)



![](image/Pasted%20image%2020240711203437.png)


![](image/Pasted%20image%2020240711203500.png)

![](image/Pasted%20image%2020240711203546.png)




















## 2.3 aws-node

![](image/Pasted%20image%2020240711202740.png)

L-IPAM: local ip adress management 

把一些ip block 分给不同的worker上面 
![](image/Pasted%20image%2020240711202918.png)


CNI-Plugin 和 L-IPAM直接的通信 是通过 gRPC 

![](image/Pasted%20image%2020240711203049.png)


![](image/Pasted%20image%2020240711203144.png)

![](image/Pasted%20image%2020240711203203.png)


![](image/Pasted%20image%2020240711203215.png)


















# 3 amazon-vpc-cni-k8s 插件

给每个 pod 配上一个vpc 中的 真实的物理地址
这样的话 pod 之间的通讯 ， 就可以 实现高效网络地址， 这样在 eks 就不需要虚拟的网络层了，


![](image/Pasted%20image%2020240711151601.png)


![](image/Pasted%20image%2020240711151649.png)

![](image/Pasted%20image%2020240711151854.png)





